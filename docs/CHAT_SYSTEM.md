# 双聊天机器人系统

## 概述

天府健康云平台现在集成了两个智能聊天助手，为用户提供不同类型的对话体验：

1. **Typebot助手** - 交互式对话流程
2. **TARS智能助手** - AI驱动的智能客服

## 功能特性

### 🤖 Typebot助手
- **特点**: 基于预设流程的交互式对话
- **优势**: 结构化问答，引导式对话
- **适用场景**: 
  - 新用户引导
  - 常见问题解答
  - 功能介绍和演示
  - 数据查询向导

### 🧠 TARS智能助手
- **特点**: 基于Claude AI的自然语言理解
- **优势**: 智能对话，上下文理解
- **适用场景**:
  - 复杂问题咨询
  - 专业知识问答
  - 个性化建议
  - 技术支持

## 用户界面

### 聊天选择器
- **位置**: 页面右下角浮动按钮
- **功能**: 
  - 点击主按钮显示聊天助手选择面板
  - 选择后启动对应的聊天助手
  - 记住用户偏好设置

### 切换功能
- **快速切换**: 在活跃聊天时显示切换按钮
- **切换菜单**: 
  - 切换到Typebot助手
  - 切换到TARS智能助手
  - 关闭所有聊天

## 技术实现

### 组件架构
```
ChatSelector.vue (聊天选择器)
├── TypebotChat.vue (Typebot助手)
└── TarsChat.vue (TARS智能助手)
```

### 状态管理
- 使用本地存储记住用户偏好
- 响应式状态管理
- 事件驱动的组件通信

### 样式设计
- 现代化UI设计
- 响应式布局
- 平滑动画过渡
- 移动端适配

## 显示规则

### 启用页面
聊天系统在以下页面显示：
- ✅ 仪表盘 (`/app/dashboard`)
- ✅ 统计分析 (`/app/statistics/*`)
- ✅ 数据可视化 (`/app/visualization/*`)
- ✅ 3D地图 (`/app/map3d`)
- ✅ 数据管理 (`/app/data/*`)
- ✅ 系统设置 (`/app/settings`)
- ✅ 帮助中心 (`/app/help`)
- ✅ 演示页面 (`/app/*-demo`)

### 禁用页面
以下页面不显示聊天系统：
- ❌ 首页 (`/`)
- ❌ 登录页 (`/login`)
- ❌ 注册页 (`/register`)

## 配置选项

### Typebot配置
```javascript
// src/config/typebot.js
export const TYPEBOT_CONFIG = {
  publicId: 'your-typebot-id',
  apiHost: 'https://typebot.io',
  // ... 其他配置
}
```

### TARS配置
```javascript
// src/services/tarsService.js
const tarsConfig = {
  convid: 'WbpUav',
  baseUrl: 'https://chatbot.hellotars.com',
  apiUrl: 'https://asimov.hellotars.com/api/run-agent'
}
```

## 用户体验

### 交互流程
1. **首次访问**: 用户看到脉冲动画的聊天按钮
2. **选择助手**: 点击按钮显示选择面板
3. **开始对话**: 选择助手类型开始对话
4. **切换助手**: 可随时切换到另一个助手
5. **记住偏好**: 系统记住用户的选择偏好

### 视觉反馈
- **脉冲动画**: 提醒用户聊天功能可用
- **状态指示**: 显示助手在线状态
- **平滑过渡**: 所有状态切换都有动画效果
- **响应式设计**: 适配不同屏幕尺寸

## 管理功能

### TARS管理界面
- **路径**: `/app/tars-management`
- **权限**: 仅管理员可访问
- **功能**: 
  - 实时统计监控
  - 配置管理
  - 对话记录查看
  - 系统状态监控

### 演示页面
- **TARS演示**: `/app/tars-demo`
- **Typebot测试**: `/app/typebot-test`
- **权限**: 所有登录用户可访问

## 最佳实践

### 用户引导
1. **新用户**: 推荐使用Typebot助手进行系统介绍
2. **有经验用户**: 推荐使用TARS智能助手进行深度咨询
3. **技术问题**: 优先使用TARS智能助手

### 内容策略
1. **Typebot**: 设计清晰的对话流程和快速操作
2. **TARS**: 维护丰富的知识库和FAQ
3. **两者结合**: 在适当时机引导用户切换助手

## 故障排除

### 常见问题
1. **聊天按钮不显示**: 检查页面路径和用户登录状态
2. **Typebot加载失败**: 检查配置和网络连接
3. **TARS无响应**: 检查API配置和服务状态
4. **切换功能异常**: 清除浏览器缓存和本地存储

### 调试方法
```javascript
// 在浏览器控制台中执行
localStorage.removeItem('preferredChatType') // 重置用户偏好
```

## 更新日志

### v1.0.0 (2024-01-10)
- ✅ 集成Typebot和TARS双聊天系统
- ✅ 实现聊天选择器和切换功能
- ✅ 添加用户偏好记忆
- ✅ 完善响应式设计
- ✅ 添加管理和演示界面

## 技术支持

如有问题或建议，请联系：
- 邮箱: 2717120274@qq.com
- 电话: 18711607090
